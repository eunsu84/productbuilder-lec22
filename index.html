<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ë§ˆìŒ ê±°ìš¸ - ë¬¸ì¥ì™„ì„±ê²€ì‚¬</title>
    <style>
        body { font-family: 'Apple SD Gothic Neo', sans-serif; background-color: #f0f2f5; padding: 20px; line-height: 1.6; }
        .container { max-width: 600px; margin: 0 auto; background: white; padding: 30px; border-radius: 15px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        h2 { color: #4a90e2; text-align: center; }
        .question { margin-bottom: 20px; }
        label { display: block; margin-bottom: 8px; font-weight: bold; color: #333; }
        input[type="text"], input[type="password"] { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px; box-sizing: border-box; }
        button { width: 100%; padding: 15px; background-color: #4a90e2; color: white; border: none; border-radius: 5px; cursor: pointer; font-size: 16px; margin-top: 20px; }
        button:hover { background-color: #357abd; }
        button:disabled { background-color: #ccc; cursor: not-allowed; }
        #result { margin-top: 30px; display: none; padding: 20px; background: #eef7ff; border-radius: 10px; }
        .result-item { margin-bottom: 10px; border-bottom: 1px dotted #ccc; padding-bottom: 5px; }
        .api-key-section { background-color: #fff3cd; padding: 15px; border-radius: 8px; margin-bottom: 20px; border: 1px solid #ffeeba; }
    </style>
</head>
<body>

<div class="container">
    <h2>ğŸ“ ë¬¸ì¥ì™„ì„±ê²€ì‚¬ (SCT)</h2>
    <p style="text-align: center; color: #666;">ê°€ì¥ ë¨¼ì € ë– ì˜¤ë¥´ëŠ” ìƒê°ì„ ì ì–´ì£¼ì„¸ìš”.</p>
    <hr>
    
    <div id="survey-form">
        <div class="api-key-section">
            <label for="api-key">ğŸ”‘ Google API Key (AI ë¶„ì„ìš©)</label>
            <input type="password" id="api-key" placeholder="API Keyë¥¼ ì…ë ¥í•˜ì„¸ìš”">
            <small style="color: #666; display: block; margin-top: 5px;">* í‚¤ëŠ” ì €ì¥ë˜ì§€ ì•Šê³  ì˜¤ì§ ë¶„ì„ ìš”ì²­ì—ë§Œ ì‚¬ìš©ë©ë‹ˆë‹¤.</small>
        </div>

        <div class="question"><label>1. ìš”ì¦˜ ë‚´ê°€ ê°€ì¥ ë§ì´ ëŠë¼ëŠ” ê°ì •ì€...</label><input type="text" id="q1" placeholder="ì´ë‹¤."></div>
        <div class="question"><label>2. ëˆ„êµ°ê°€ ë‚˜ë¥¼ ë¬´ì‹œí•œë‹¤ê³  ëŠë‚„ ë•Œ ë‚˜ëŠ”...</label><input type="text" id="q2" placeholder="í•œë‹¤."></div>
        <div class="question"><label>3. ê°ˆë“±ì´ ìƒê¸°ë©´ ë‚˜ëŠ” ë³´í†µ...</label><input type="text" id="q3" placeholder="í•œë‹¤."></div>
        <div class="question"><label>4. ë‚´ê°€ ê°€ì¥ í”¼í•˜ê³  ì‹¶ì€ ìƒí™©ì€...</label><input type="text" id="q4" placeholder="ì´ë‹¤."></div>
        <div class="question"><label>5. ì‚¬ëŒë“¤ê³¼ í•¨ê»˜ ìˆì„ ë•Œ ë‚˜ëŠ”...</label><input type="text" id="q5" placeholder="í•œ í¸ì´ë‹¤."></div>
        <div class="question"><label>6. ë‚´ ì„±ê²©ì˜ ì¥ì ì€...</label><input type="text" id="q6" placeholder="ì´ë‹¤."></div>
        <div class="question"><label>7. ë‚´ ì„±ê²©ì˜ ë‹¨ì ì€...</label><input type="text" id="q7" placeholder="ì´ë‹¤."></div>
        <div class="question"><label>8. ë‚˜ë¥¼ í˜ë“¤ê²Œ í•˜ëŠ” ì‚¬ëŒì€ ë³´í†µ...</label><input type="text" id="q8" placeholder="í•œ ì‚¬ëŒì´ë‹¤."></div>
        <div class="question"><label>9. í™”ê°€ ë‚˜ë„ ë‚˜ëŠ” ì£¼ë¡œ...</label><input type="text" id="q9" placeholder="í•œë‹¤."></div>
        <div class="question"><label>10. ì§€ê¸ˆì˜ ë‚˜ëŠ”...</label><input type="text" id="q10" placeholder="í•œ ìƒíƒœë¼ê³  ìƒê°í•œë‹¤."></div>
        
        <button id="submit-btn" onclick="showResult()">AI ë¶„ì„ ê²°ê³¼ í™•ì¸í•˜ê¸°</button>
    </div>

    <div id="result">
        <h3>ğŸ“Š ê²€ì‚¬ ê²°ê³¼ ìš”ì•½</h3>
        <div id="result-content"></div>
        
        <div id="analysis-section" style="margin-top: 25px; padding-top: 20px; border-top: 2px dashed #ccc;">
            <h4 style="color: #4a90e2;">ğŸ§  ì‹¬ë¦¬ ìƒíƒœ ë¶„ì„ (AI)</h4>
            <div id="loading-spinner" style="display: none; text-align: center; color: #666;">
                <p>AIê°€ ë¶„ì„ ì¤‘ì…ë‹ˆë‹¤... ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš” ğŸ¤–</p>
            </div>
            <p id="psych-analysis" style="font-weight: bold; color: #555;"></p>
            
            <h4 style="color: #2ecc71; margin-top: 20px;">ğŸ’¡ ë§ì¶¤í˜• ì†”ë£¨ì…˜</h4>
            <div id="solution-box" style="background: white; padding: 15px; border-left: 4px solid #2ecc71; border-radius: 4px;">
                <p id="psych-solution" style="margin: 0; color: #333;"></p>
            </div>
        </div>

        <p style="font-size: 0.9em; color: #777; margin-top: 20px;">* ë³¸ ê²°ê³¼ëŠ” AI(Gemini) ë¶„ì„ ê²°ê³¼ì´ë©°, ì „ë¬¸ì ì¸ ì˜í•™ì  ì§„ë‹¨ì´ ì•„ë‹™ë‹ˆë‹¤.</p>
        <button onclick="location.reload()" style="background-color: #999;">ë‹¤ì‹œ ì‘ì„±í•˜ê¸°</button>
    </div>
</div>

<script>
    async function showResult() {
        const apiKey = document.getElementById('api-key').value;
        if (!apiKey) {
            alert('ì •í™•í•œ ë¶„ì„ì„ ìœ„í•´ Google API Keyë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
            return;
        }

        const questions = [
            "ê°€ì¥ ë§ì´ ëŠë¼ëŠ” ê°ì •", "ë¬´ì‹œë‹¹í•  ë•Œì˜ ë°˜ì‘", "ê°ˆë“± í•´ê²° ë°©ì‹", 
            "í”¼í•˜ê³  ì‹¶ì€ ìƒí™©", "ëŒ€ì¸ê´€ê³„ ìŠ¤íƒ€ì¼", "ì„±ê²©ì˜ ì¥ì ", 
            "ì„±ê²©ì˜ ë‹¨ì ", "í˜ë“¤ê²Œ í•˜ëŠ” íƒ€ì¸ ìœ í˜•", "ë¶„ë…¸ ì¡°ì ˆ ë°©ì‹", "í˜„ì¬ì˜ ìì•„ ìƒíƒœ"
        ];
        
        let answersData = [];
        let resultHtml = "";
        
        for(let i=1; i<=10; i++) {
            let answer = document.getElementById('q' + i).value;
            if(!answer) answer = "(ë¯¸ì…ë ¥)";
            
            answersData.push({ question: questions[i-1], answer: answer });
            resultHtml += `<div class="result-item"><strong>${questions[i-1]}:</strong> ${answer}</div>`;
        }

        // UI ì „í™˜ ë° ë¡œë”© í‘œì‹œ
        document.getElementById('survey-form').style.display = 'none';
        document.getElementById('result-content').innerHTML = resultHtml;
        document.getElementById('result').style.display = 'block';
        document.getElementById('loading-spinner').style.display = 'block';
        document.getElementById('psych-analysis').innerText = "";
        document.getElementById('psych-solution').innerText = "";

        // AI í”„ë¡¬í”„íŠ¸ êµ¬ì„±
        const prompt = `
            ë‹¹ì‹ ì€ ì „ë¬¸ ì‹¬ë¦¬ ìƒë‹´ê°€ì…ë‹ˆë‹¤. ì‚¬ìš©ìì˜ ë¬¸ì¥ì™„ì„±ê²€ì‚¬(SCT) ë‹µë³€ì„ ë°”íƒ•ìœ¼ë¡œ ì•„ë“¤ëŸ¬ ì‹¬ë¦¬í•™(Adlerian Psychology) ê´€ì ì—ì„œ ì‹¬ë¦¬ ìƒíƒœë¥¼ ë¶„ì„í•´ì£¼ì„¸ìš”.
            
            [ì‚¬ìš©ì ë‹µë³€]
            ${answersData.map(a => `- ${a.question}: ${a.answer}`).join('\n')}

            ë‹¤ìŒ í˜•ì‹ì˜ JSONìœ¼ë¡œë§Œ ì‘ë‹µí•´ì£¼ì„¸ìš” (ë§ˆí¬ë‹¤ìš´ ì—†ì´ ìˆœìˆ˜ JSON):
            {
                "type": "ì•„ë“¤ëŸ¬ì˜ ìƒí™œì–‘ì‹ ìœ í˜• (ì˜ˆ: ì‚¬íšŒì  ìœ ìš©í˜•, ì§€ë°°í˜•, ê¸°ìƒí˜•, íšŒí”¼í˜• ì¤‘ í•˜ë‚˜)",
                "analysis": "ë‹µë³€ì„ ì¢…í•©ì ìœ¼ë¡œ ë¶„ì„í•œ ì‹¬ë¦¬ ìƒíƒœ ì„¤ëª… (3ë¬¸ì¥ ë‚´ì™¸)",
                "solution": "ì•„ë“¤ëŸ¬ ì‹¬ë¦¬í•™ì— ê¸°ë°˜í•œ êµ¬ì²´ì ì¸ ì¡°ì–¸ê³¼ ê²©ë ¤ (3ë¬¸ì¥ ë‚´ì™¸)"
            }
        `;

        try {
            const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${apiKey}`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    contents: [{ parts: [{ text: prompt }] }]
                })
            });

            if (!response.ok) throw new Error('API í˜¸ì¶œ ì‹¤íŒ¨');

            const data = await response.json();
            const text = data.candidates[0].content.parts[0].text;
            
            // JSON íŒŒì‹± (ë§ˆí¬ë‹¤ìš´ ì½”ë“œë¸”ëŸ­ì´ ìˆì„ ê²½ìš° ì œê±°)
            const cleanText = text.replace(/```json/g, '').replace(/```/g, '').trim();
            const result = JSON.parse(cleanText);

            document.getElementById('loading-spinner').style.display = 'none';
            document.getElementById('psych-analysis').innerHTML = `<strong style='color:#333; font-size: 1.2em;'>${result.type}</strong><br><br>${result.analysis}`;
            document.getElementById('psych-solution').innerText = result.solution;

        } catch (error) {
            console.error(error);
            document.getElementById('loading-spinner').style.display = 'none';
            document.getElementById('psych-analysis').innerText = "ë¶„ì„ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. API Keyë¥¼ í™•ì¸í•˜ê±°ë‚˜ ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.";
            document.getElementById('survey-form').style.display = 'block'; // ë‹¤ì‹œ ì‹œë„í•  ìˆ˜ ìˆê²Œ í¼ í‘œì‹œ
            document.getElementById('result').style.display = 'none';
            alert("AI ë¶„ì„ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: " + error.message);
        }
    }
</script>

</body>
</html>